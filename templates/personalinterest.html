{% block bar %}
    {% include "base.html" %}
{% endblock %}
<style>
    .ul.select2-selection__rendered {
        padding: 5px 5px 5px 5px !important;
    }
</style>
<!DOCTYPE html>
<html>
<head>
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/personalinterest.css' %}"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.min.js"></script>
    <script src={% static 'js/personalinterest-js.js' %}></script>
</head>
<body>
<div class="alert alert-info alert-dismissable">
    <button type="button" class="close" aria-hidden="true">&times;</button>
    <p id="alertmsgtext"></p>
</div>

<header class="intro-header">
    <div class="transbox"></div>
    <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <h1 style="color:white;text-align: center;text-shadow: #d3d3d3 0px 0px 1px;">Pick Your Own
                Interest!</h1>
            <hr class="small">

            <select class="col-md-12 js-example-basic-multiple" multiple="multiple"
                    style="padding: 5px 5px 5px 5px!important;">
            </select>
        </div>
    </div>
    <div class="row" style="text-align:center;z-index:100;position: relative">
        <button class="btn btn-primary" style="width:15%;margin-top:30px;" id="save-interest-btn"> Save</button>
    </div>
</header>
</body>
</html>

{% load static %}
<script src="{% static 'js/ajaxpost.js' %}"></script>
<script>
    $(function () {

        {#initialize multiselect#}
        $('select').select2();
        $.ajax({
            type: 'GET',
            url: '/personalinterestsectordropdown/',
            dataType: 'json',
            success: function (data) {
                console.log(data);
                var fields = data.results;
                var htmlToAppend = "";
                for (var i = 0; i < fields.length; i++) {
                    htmlToAppend += '<option value="' + fields[i] + '">' + fields[i] + '</option>'
                }
                $('.js-example-basic-multiple').append(htmlToAppend);
            }
        });

        $(".js-example-basic-multiple").select2();

        $("#save-interest-btn").click(function () {
            var dataString = '&interestinput=' + $(".js-example-basic-multiple").val();
            console.log(dataString);

            var interestarray = [];
            $(".js-example-basic-multiple option:selected").each(function () {
                interestarray.push($(this).val());
            });
            console.log(interestarray);
            $.ajax({
                type: 'POST',
                url: '/interestinput/',
                data: {'interestarray[]': interestarray},
                success: function (data) {
                    if (data.status == 'success') {
{#                        alert(data.message);#}
                        $('#alertmsgtext').html(data.message);
                    } else {
                        alert(data.message);
                    }
                }
            });

        });

        $(".alert button.close").click(function () {
            $(this).parent().fadeOut('fast');
        });
    });
</script>